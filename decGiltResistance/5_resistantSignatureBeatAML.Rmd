---
title: "Fig 4 BeatAML Analysis"
author: "Sara Gosline"
date: "2024-08-07"
output: html_document
---

# Figure 4 generation

Here we use the proteomics measurements to derive a signature of resistance and apply it to BeatAML samples and evaluate drug response.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyr)
library(readr)
library(dplyr)
library(pheatmap)
```

## Load kinase and pathway results

Here we want to load the proteomics and phospho data again

```{r data, warning=FALSE, message=FALSE}


phospho<-do.call(rbind,lapply(setdiff(names(conds),'Parental'),function(x){
  readr::read_csv(paste0('diff_ex_phospho_',x,'-none_Parental.csv'))|>
    mutate(condition=conds[x])
}))
phospho|>subset(adj.P.Val<0.05)|>group_by(condition)|>summarize(numFeatures=n())


prot<-do.call(rbind,lapply(setdiff(names(conds),'Parental'),function(x){
  readr::read_csv(paste0('diff_ex',x,'-none_Parental.csv'))|>
    mutate(condition=conds[x])
}))


##all metdata here
conds<-c("Decitabine Resistant","Early Gilteritinib Resistant","Late Gilteritinib Resistant","Early Gilteritinib/Decitabine Resistant","Late Gilteritinib/Decitabine Resistant",'Parental')
names(conds)=c('D_only','G_Early','G_Late','GD_Early','GD_Late','Parental')

##condition specific color scheme
colc<-c('#B75E5C','#E66100','#FFC20A','#0C7BDC','#44AA99','#AAAAAA')
names(colc)<-conds

#drug specific color scheme
dcolc<-colc[c(1,3,5,6)]
names(dcolc)=c('Decitabine','Gilteritinib','Gilteritinib/Decitabine','Parental')

```

Top pathways up-regulated in resistant cell lines?
```{r sigs, message=FALSE,warning=FALSE}

#for each condition, generate a signature of proteins and weights

#visualize that using heatmaps?
```

## BeatAML analysis

Get beataml samples, apply signatures to each sample

```{r beatAML, message=FALSE,warning=FALSE}


```



Now we can look at the drug response for each of those samples

```{r drug response}

```


